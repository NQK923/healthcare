<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Health Regulation Views -->
    <record id="view_health_regulation_form" model="ir.ui.view">
        <field name="name">health.regulation.form</field>
        <field name="model">health.regulation</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive">
                            <field name="active" widget="boolean_button"/>
                        </button>
                    </div>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Tên quy định"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="code"/>
                            <field name="authority_id"/>
                            <field name="scope"/>
                        </group>
                        <group>
                            <field name="issue_date"/>
                            <field name="effective_date"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Mô tả">
                            <field name="description"/>
                        </page>
                        <page string="Đánh giá tuân thủ">
                            <field name="compliance_ids">
                                <tree>
                                    <field name="name"/>
                                    <field name="date_assessment"/>
                                    <field name="state"/>
                                    <field name="responsible_id"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Tài liệu">
                            <field name="attachment_ids" widget="many2many_binary"/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <record id="view_health_regulation_tree" model="ir.ui.view">
        <field name="name">health.regulation.tree</field>
        <field name="model">health.regulation</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="code"/>
                <field name="authority_id"/>
                <field name="scope"/>
                <field name="effective_date"/>
            </tree>
        </field>
    </record>

    <record id="view_health_regulation_search" model="ir.ui.view">
        <field name="name">health.regulation.search</field>
        <field name="model">health.regulation</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="code"/>
                <field name="authority_id"/>
                <separator/>
                <filter string="Quốc gia" name="national" domain="[('scope', '=', 'national')]"/>
                <filter string="Quốc tế" name="international" domain="[('scope', '=', 'international')]"/>
                <filter string="Địa phương" name="local" domain="[('scope', '=', 'local')]"/>
                <group expand="0" string="Nhóm theo">
                    <filter string="Cơ quan ban hành" name="group_by_authority" context="{'group_by': 'authority_id'}"/>
                    <filter string="Phạm vi" name="group_by_scope" context="{'group_by': 'scope'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Health Compliance Views -->
    <record id="view_health_compliance_form" model="ir.ui.view">
        <field name="name">health.compliance.form</field>
        <field name="model">health.compliance</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <field name="state" widget="statusbar" statusbar_visible="draft,in_progress,compliant,non_compliant,partly_compliant"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Tên đánh giá"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="regulation_id"/>
                            <field name="department_id"/>
                            <field name="responsible_id"/>
                        </group>
                        <group>
                            <field name="date_assessment"/>
                            <field name="next_assessment"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Ghi chú">
                            <field name="notes"/>
                        </page>
                        <page string="Hành động khắc phục">
                            <field name="action_ids">
                                <tree editable="bottom">
                                    <field name="name"/>
                                    <field name="description"/>
                                    <field name="responsible_id"/>
                                    <field name="deadline"/>
                                    <field name="state"/>
                                    <field name="completion_date"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Tài liệu">
                            <field name="attachment_ids" widget="many2many_binary"/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <record id="view_health_compliance_tree" model="ir.ui.view">
        <field name="name">health.compliance.tree</field>
        <field name="model">health.compliance</field>
        <field name="arch" type="xml">
            <tree decoration-danger="state=='non_compliant'" decoration-success="state=='compliant'" decoration-warning="state=='partly_compliant'">
                <field name="name"/>
                <field name="regulation_id"/>
                <field name="date_assessment"/>
                <field name="next_assessment"/>
                <field name="state"/>
                <field name="responsible_id"/>
            </tree>
        </field>
    </record>

    <record id="view_health_compliance_search" model="ir.ui.view">
        <field name="name">health.compliance.search</field>
        <field name="model">health.compliance</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="regulation_id"/>
                <field name="department_id"/>
                <field name="responsible_id"/>
                <separator/>
                <filter string="Tuân thủ" name="compliant" domain="[('state', '=', 'compliant')]"/>
                <filter string="Không tuân thủ" name="non_compliant" domain="[('state', '=', 'non_compliant')]"/>
                <filter string="Đánh giá trong tháng" name="assessment_this_month" domain="[('date_assessment', '&gt;=', (context_today() + relativedelta(day=1)).strftime('%Y-%m-%d')), ('date_assessment', '&lt;=', (context_today() + relativedelta(months=1, day=1, days=-1)).strftime('%Y-%m-%d'))]"/>
                <group expand="0" string="Nhóm theo">
                    <filter string="Quy định" name="group_by_regulation" context="{'group_by': 'regulation_id'}"/>
                    <filter string="Phòng ban" name="group_by_department" context="{'group_by': 'department_id'}"/>
                    <filter string="Trạng thái" name="group_by_state" context="{'group_by': 'state'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Health Authority Views -->
    <record id="view_health_authority_form" model="ir.ui.view">
        <field name="name">health.authority.form</field>
        <field name="model">health.authority</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Tên cơ quan"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="code"/>
                            <field name="country_id"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Mô tả">
                            <field name="description"/>
                        </page>
                        <page string="Quy định">
                            <field name="regulation_ids">
                                <tree>
                                    <field name="name"/>
                                    <field name="code"/>
                                    <field name="issue_date"/>
                                    <field name="effective_date"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_health_authority_tree" model="ir.ui.view">
        <field name="name">health.authority.tree</field>
        <field name="model">health.authority</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="code"/>
                <field name="country_id"/>
            </tree>
        </field>
    </record>

    <!-- Menu Items -->
    <record id="menu_health_compliance_root" model="ir.ui.menu">
        <field name="name">Quản lý Tuân thủ Y tế</field>
        <field name="web_icon">health_compliance,static/description/icon.png</field>
        <field name="sequence">90</field>
    </record>

    <record id="menu_health_compliance" model="ir.ui.menu">
        <field name="name">Đánh giá Tuân thủ</field>
        <field name="parent_id" ref="menu_health_compliance_root"/>
        <field name="sequence">10</field>
    </record>

    <record id="menu_health_regulation" model="ir.ui.menu">
        <field name="name">Quy định Y tế</field>
        <field name="parent_id" ref="menu_health_compliance_root"/>
        <field name="sequence">20</field>
    </record>

    <record id="menu_health_authority" model="ir.ui.menu">
        <field name="name">Cơ quan Quản lý</field>
        <field name="parent_id" ref="menu_health_compliance_root"/>
        <field name="sequence">30</field>
    </record>

    <!-- Actions -->
    <record id="action_health_compliance" model="ir.actions.act_window">
        <field name="name">Đánh giá Tuân thủ</field>
        <field name="res_model">health.compliance</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_health_compliance_search"/>
    </record>

    <record id="action_health_regulation" model="ir.actions.act_window">
        <field name="name">Quy định Y tế</field>
        <field name="res_model">health.regulation</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_health_regulation_search"/>
    </record>

    <record id="action_health_authority" model="ir.actions.act_window">
        <field name="name">Cơ quan Quản lý</field>
        <field name="res_model">health.authority</field>
        <field name="view_mode">tree,form</field>
    </record>

    <!-- Menu Actions -->
    <menuitem id="menu_action_health_compliance"
              name="Đánh giá Tuân thủ"
              parent="menu_health_compliance"
              action="action_health_compliance"
              sequence="10"/>

    <menuitem id="menu_action_health_regulation"
              name="Quy định Y tế"
              parent="menu_health_regulation"
              action="action_health_regulation"
              sequence="10"/>

    <menuitem id="menu_action_health_authority"
              name="Cơ quan Quản lý"
              parent="menu_health_authority"
              action="action_health_authority"
              sequence="10"/>
</odoo>